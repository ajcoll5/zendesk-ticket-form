!function(a,b,c,d){var e=function(){function c(a){return!a||!a.trim()}function d(b){return!b.match(a)}function e(a){return"blank"+a[0].toUpperCase()+a.slice(1)}function f(a,c){return{name:b[a],message:c[e(a)]}}function g(a,c){return{name:b[a],message:c.invalidRequester}}function h(a,b,e){var h;for(var i in b)c(b[i])?(h=f(i,e),a.errors.push(h)):"requester"===i&&d(b[i])&&(h=g(i,e),a.errors.push(h))}function i(a){return{validate:function(b){var c={valid:!1,errors:[]};return h(c,b,a),c.errors.length||(c.valid=!0),c}}}var a=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,b={name:"name",requester:"email",subject:"reason",description:"description"};return{new:i}}(),f=function(){function b(a){return Object.keys(a).map(function(b){return"z_"+encodeURIComponent(b)+"="+encodeURIComponent(a[b])}).join("&")}function c(c,d){function f(a){var b=JSON.parse(a);b.ticket?e.handleSuccess(b.ticket):b.errors?e.handleErrors(b.errors):e.handleFailure(a)}function g(d){a.ajax({url:c,type:"POST",data:b(d),success:f,error:e.handleFailure})}var e={handleSuccess:function(a){},handleErrors:function(a){},handleFailure:function(a){}};return{setCallbacks:function(a){for(var b in a)e[b]=a[b]},submit:function(a){var b=d.validate(a);b.valid?g(a,e):e.handleErrors(b.errors)}}}return{new:c}}(),g=function(){function a(a,b){function e(){return{name:a.name.val(),requester:a.email.val(),subject:a.reason.val(),description:a.description.val()}}var c,d={};return a.name=a.find("#name"),a.email=a.find("#email"),a.reason=a.find("#reason"),a.description=a.find("#description"),c={init:function(){b.setCallbacks(d),a.submit(function(a){a.preventDefault(),a.stopPropagation(),b.submit(e())})},setCallback:function(b,e){return d[b]=e.bind(a),c}}}return{new:a}}(),h=function(a){if(!a)throw new Error("You must provide a 'callbacks' object arg to #zendeskTicketForm");if(!a.handleSuccess||"function"!=typeof a.handleSuccess)throw new Error("You must provide a 'handleSuccess' function to the 'callbacks' arg");if(!a.handleFailure||"function"!=typeof a.handleFailure)throw new Error("You must provide a 'handleFailure' function to the 'callbacks' arg");if(!a.handleErrors||"function"!=typeof a.handleErrors)throw new Error("You must provide a 'handleErrors' function to the 'callbacks' arg")};a.fn.extend({zendeskTicketForm:function(a){h(a);var b=e.new({blankName:this.find("#name").data("blank"),blankRequester:this.find("#email").data("blank"),invalidRequester:this.find("#email").data("invalid"),blankSubject:this.find("#reason").data("blank"),blankDescription:this.find("#description").data("blank")}),c=f.new(this.data("url"),b),d=g.new(this,c);for(var i in a)d.setCallback(i,a[i]);return d.init(),this}})}(jQuery,window,document);
