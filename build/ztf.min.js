!function(a,b,c){var d=function(){function c(a){return!a||!a.trim()}function d(b){return!b.match(a)}function e(a){return"blank"+a[0].toUpperCase()+a.slice(1)}function f(a,c){return{name:b[a],message:c[e(a)]}}function g(a,c){return{name:b[a],message:c.invalidRequester}}function h(a,b,e){var h;for(var i in b)c(b[i])?(h=f(i,e),a.errors.push(h)):"requester"===i&&d(b[i])&&(h=g(i,e),a.errors.push(h))}function i(a){return{validate:function(b){var c={valid:!1,errors:[]};return h(c,b,a),c.errors.length||(c.valid=!0),c}}}var a=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,b={name:"name",requester:"email",subject:"reason",description:"description"};return{new:i}}(),e=function(){function b(a){return Object.keys(a).map(function(b){return"z_"+encodeURIComponent(b)+"="+encodeURIComponent(a[b])}).join("&")}function c(c,d){function f(b){try{var c=a.JSON.parse(b.responseText);c.ticket?e.handleSuccess(c.ticket):c.errors?e.handleErrors(c.errors):e.handleFailure(c)}catch(a){e.handleFailure(b)}}function g(d){var g=new a.XMLHttpRequest;g.open("POST",c,!0),g.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),g.onreadystatechange=function(a){4===g.readyState&&(200===g.status?f(g):e.handleFailure(g))},g.onerror=function(a){e.handleFailure(g)},g.send(b(d))}var e={handleSuccess:function(a){},handleErrors:function(a){},handleFailure:function(a){}};return{setCallbacks:function(a){for(var b in a)e[b]=a[b]},submit:function(a){var b=d.validate(a);b.valid?g(a,e):e.handleErrors(b.errors)}}}return{new:c}}(),f=function(){function b(a){return a=[].slice.call(a).filter(function(a){return!!a.attributes&&!!a.attributes.id}),function(b){var c;return a.forEach(function(a){a.attributes.id.textContent===b&&(c=a)}),c}}function c(a){var c=b(a.getElementsByTagName("*"));["name","reason","email","description"].forEach(function(b){a[b]=c(b)})}function d(b){if(b.constructor===a.HTMLSelectElement){var c=b.options[b.selectedIndex];return c.disabled?null:c.value}return b.value}function e(a,b){function g(){return{name:a.name.value,requester:a.email.value,subject:d(a.reason),description:a.description.value}}var e,f={};return c(a),e={init:function(){b.setCallbacks(f),a.onsubmit=function(a){a.preventDefault(),a.stopPropagation(),b.submit(g())}},setCallback:function(b,c){return f[b]=c.bind(a),e}}}return{new:e}}(),g=function(a){if(!a)throw new Error("You must provide a 'callbacks' object arg to #zendeskTicketForm");if(!a.handleSuccess||"function"!=typeof a.handleSuccess)throw new Error("You must provide a 'handleSuccess' function to the 'callbacks' arg");if(!a.handleFailure||"function"!=typeof a.handleFailure)throw new Error("You must provide a 'handleFailure' function to the 'callbacks' arg");if(!a.handleErrors||"function"!=typeof a.handleErrors)throw new Error("You must provide a 'handleErrors' function to the 'callbacks' arg")},h=function(){function a(a){return a=[].slice.call(a).filter(function(a){return!!a.attributes&&!!a.attributes.id}),function(b,c){var d;return a.forEach(function(a){a.attributes.id.textContent===b&&(d=a.dataset[c])}),d}}function b(b){var c=a(b.getElementsByTagName("*"));return{blankName:c("name","blank"),blankRequester:c("email","blank"),invalidRequester:c("email","invalid"),blankSubject:c("reason","blank"),blankDescription:c("description","blank")}}return function(a){g(a);var c=d.new(b(this)),h=e.new(this.dataset.url,c);return f.new(this,h).setCallback("handleSuccess",a.handleSuccess).setCallback("handleFailure",a.handleFailure).setCallback("handleErrors",a.handleErrors).init(),this}}();a.HTMLFormElement.prototype.zendeskTicketForm=h}(window,document);
